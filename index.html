<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIé‡åŒ–è·Ÿå–®</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background-color: #000; color: #fff; min-height: 100vh; }
        .page { display: none; min-height: 100vh; }
        .page.active { display: block; }
        .header { display: flex; justify-content: space-between; align-items: center; padding: 16px; position: sticky; top: 0; background: #000; z-index: 100; }
        .back-btn { width: 32px; height: 32px; background: #222; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; }
        .back-btn::before { content: 'â€¹'; font-size: 20px; color: #fff; }
        .header-title { font-size: 18px; font-weight: 600; }
        .rules-btn { font-size: 14px; color: #fff; cursor: pointer; }
        .placeholder { width: 32px; }
        .container { padding: 0 12px 24px; }
        .card { background: #1a1a1a; border-radius: 16px; padding: 20px; margin-bottom: 12px; }
        .card-title { font-size: 18px; font-weight: 600; margin-bottom: 6px; }
        .card-users { font-size: 13px; color: #888; margin-bottom: 16px; }
        .card-users::before { content: 'ğŸ‘¥ '; }
        .card-profit-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
        .card-profit-left { }
        .card-profit-label { font-size: 13px; color: #888; margin-bottom: 4px; }
        .card-profit-value { font-size: 20px; font-weight: 700; color: #0d956f; }
        .card-chart { width: 120px; height: 50px; }
        .card-chart svg { width: 100%; height: 100%; }
        .card-stats { display: flex; justify-content: space-between; margin-bottom: 16px; padding-bottom: 16px; border-bottom: 1px solid #333; }
        .card-stat { text-align: center; flex: 1; }
        .card-stat:first-child { text-align: left; }
        .card-stat:last-child { text-align: right; }
        .card-stat-label { font-size: 12px; color: #888; margin-bottom: 4px; }
        .card-stat-value { font-size: 14px; color: #fff; font-weight: 500; }
        .card-extra { display: flex; justify-content: space-between; margin-bottom: 16px; }
        .card-extra-item { }
        .card-extra-label { font-size: 12px; color: #888; margin-bottom: 4px; }
        .card-extra-value { font-size: 14px; color: #fff; }
        .join-btn { width: 100%; padding: 14px; margin-top: 16px; border-radius: 25px; background: rgba(0, 244, 255, 1); border: none; color: #000; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s; }
        .join-btn:hover { background: rgba(0, 244, 255, 0.85); }
        .limit-text { text-align: center; color: rgba(0, 244, 255, 1); font-size: 13px; margin-top: 12px; }
        /* è¯¦æƒ…é¡µæ ·å¼ */
        .detail-container { padding: 0 16px 100px; }
        .section-label { font-size: 16px; color: #fff; margin: 20px 0 12px; font-weight: 500; }
        .product-name { font-size: 18px; color: rgba(0, 244, 255, 1); margin-bottom: 20px; }
        .input-box { display: flex; align-items: center; background: #1a1a1a; border-radius: 12px; padding: 14px 16px; margin-bottom: 8px; }
        .input-box input { flex: 1; background: transparent; border: none; color: #fff; font-size: 16px; outline: none; }
        .input-box input::placeholder { color: #666; }
        .input-box .unit { color: #888; margin-right: 12px; }
        .input-box .all-btn { color: rgba(0, 244, 255, 1); cursor: pointer; }
        .balance-row { display: flex; align-items: center; color: #888; font-size: 14px; margin-bottom: 20px; }
        .balance-row .add-icon { color: rgba(0, 244, 255, 1); margin-left: 6px; font-size: 18px; cursor: pointer; }
        .info-row { display: flex; justify-content: space-between; padding: 14px 0; border-bottom: 1px solid #1a1a1a; }
        .info-row .label { color: #888; font-size: 14px; }
        .info-row .value { color: #fff; font-size: 14px; }
        .info-row .value.highlight { color: #0d956f; }
        .rule-item { display: flex; align-items: center; padding: 12px 0; }
        .rule-dot { width: 8px; height: 8px; background: rgba(0, 244, 255, 1); border-radius: 50%; margin-right: 12px; }
        .rule-label { flex: 1; color: #888; font-size: 14px; }
        .rule-value { color: #fff; font-size: 14px; }
        .agreement { display: flex; align-items: flex-start; padding: 20px 16px; }
        .checkbox { width: 20px; height: 20px; border: 2px solid #444; border-radius: 50%; margin-right: 10px; cursor: pointer; flex-shrink: 0; margin-top: 2px; }
        .checkbox.checked { background: rgba(0, 244, 255, 1); border-color: rgba(0, 244, 255, 1); }
        .agreement-text { font-size: 14px; color: #888; line-height: 1.5; }
        .agreement-text a { color: rgba(0, 244, 255, 1); text-decoration: none; }
        .confirm-btn { width: calc(100% - 32px); margin: 10px 16px 30px; padding: 14px; background: rgba(0, 244, 255, 1); border: none; border-radius: 25px; color: #000; font-size: 16px; font-weight: 600; cursor: pointer; }
        /* è¯¦æƒ…é¡µå›¾è¡¨æ ·å¼ */
        .chart-section { background: #1a1a1a; border-radius: 12px; padding: 16px; margin: 16px 0; }
        .chart-title { font-size: 18px; color: #fff; font-weight: 600; margin-bottom: 16px; }
        .chart-summary { display: flex; justify-content: space-between; margin-bottom: 16px; }
        .chart-summary-left, .chart-summary-right { }
        .chart-summary-right { text-align: right; }
        .chart-summary-label { font-size: 13px; color: #888; margin-bottom: 4px; }
        .chart-summary-value { font-size: 22px; font-weight: 600; }
        .chart-summary-value.green { color: #0d956f; }
        .chart-summary-value.red { color: #e34d4d; }
        .chart-container { position: relative; height: 200px; margin-top: 10px; }
        .chart-tooltip { position: absolute; background: rgba(255,255,255,0.95); color: #222; padding: 8px 12px; border-radius: 8px; font-size: 13px; pointer-events: none; opacity: 0; transition: opacity 0.2s; z-index: 100; box-shadow: 0 2px 8px rgba(0,0,0,0.15); }
        .chart-tooltip.show { opacity: 1; }
        .chart-tooltip .tooltip-time { color: #666; margin-bottom: 4px; }
        .chart-tooltip .tooltip-value { font-weight: 600; }
        .chart-tooltip .tooltip-value.green { color: #0d956f; }
        .chart-tooltip .tooltip-value.red { color: #e34d4d; }
        /* ç­–ç•¥ä¼˜åŠ¿æ ·å¼ */
        .strategy-features { margin-top: 12px; }
        .feature-item { display: flex; align-items: flex-start; padding: 14px 0; border-bottom: 1px solid #1a1a1a; }
        .feature-item:last-child { border-bottom: none; }
        .feature-icon { width: 32px; height: 32px; margin-right: 14px; flex-shrink: 0; display: flex; align-items: center; justify-content: center; background: rgba(0, 244, 255, 0.1); border-radius: 8px; }
        .feature-icon svg { width: 18px; height: 18px; }
        .feature-content { flex: 1; }
        .feature-title { font-size: 15px; color: #fff; font-weight: 500; margin-bottom: 4px; }
        .feature-desc { font-size: 13px; color: #888; line-height: 1.4; }
        /* æ”¶ç›Šåˆ†æå›¾è¡¨æ ·å¼ */
        .analysis-chart-card { background: #1a1a1a; border-radius: 12px; padding: 16px; margin-bottom: 16px; }
        .analysis-chart-title { font-size: 15px; color: rgba(0, 244, 255, 1); font-weight: 500; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }
        .analysis-chart-title::before { content: ''; width: 4px; height: 16px; background: rgba(0, 244, 255, 1); border-radius: 2px; }
        .analysis-chart-box { height: 200px; position: relative; }
    </style>
</head>
<body>
    <!-- åˆ—è¡¨é¡µ -->
    <div id="listPage" class="page active">
        <div class="header">
            <div class="back-btn"></div>
            <div class="header-title">AIé‡åŒ–è·Ÿå–®</div>
            <div class="rules-btn">è¦å‰‡èªªæ˜</div>
        </div>
        <div class="container">
            <div class="card" data-name="AI Copy ç†±ç´æ‰£é©…å‹•ç­–ç•¥" data-min="100" data-max="2,000" data-rate-min="18" data-rate-max="20">
                <div class="card-title">AI Copy ç†±ç´æ‰£é©…å‹•ç­–ç•¥</div>
                <div class="card-users">912666</div>
                <div class="card-profit-row">
                    <div class="card-profit-left">
                        <div class="card-profit-label">æ”¶ç›Šé¡ (USDT)</div>
                        <div class="card-profit-value">$14,978.87</div>
                    </div>
                    <div class="card-chart"></div>
                </div>
                <div class="card-stats">
                    <div class="card-stat"><div class="card-stat-label">æ”¶ç›Šç‡</div><div class="card-stat-value">18%-20%</div></div>
                    <div class="card-stat"><div class="card-stat-label">æœ€å°æŠ•è³‡é¡</div><div class="card-stat-value">100 USDT</div></div>
                </div>
                <div class="card-extra">
                    <div class="card-extra-item"><div class="card-extra-label">é‹è¡Œæ™‚é–“</div><div class="card-extra-value">6å¤© 20æ™‚ 12åˆ†</div></div>
                    <div class="card-extra-item"><div class="card-extra-label">7å¤©æœ€å¤§å›æ’¤</div><div class="card-extra-value">2.31%</div></div>
                </div>
                <button class="join-btn" onclick="openDetail(this)">ç«‹å³åƒèˆ‡</button>
                <div class="limit-text">æ¯æœˆé™åƒèˆ‡1æ¬¡</div>
            </div>
            <div class="card" data-name="AI Copy Alphaä¸»å‹•å¼ç®¡ç†ç­–ç•¥" data-min="2,000" data-max="9,999" data-rate-min="16" data-rate-max="20">
                <div class="card-title">AI Copy Alphaä¸»å‹•å¼ç®¡ç†ç­–ç•¥</div>
                <div class="card-users">697358</div>
                <div class="card-profit-row">
                    <div class="card-profit-left">
                        <div class="card-profit-label">æ”¶ç›Šé¡ (USDT)</div>
                        <div class="card-profit-value">$23,456.12</div>
                    </div>
                    <div class="card-chart"></div>
                </div>
                <div class="card-stats">
                    <div class="card-stat"><div class="card-stat-label">æ”¶ç›Šç‡</div><div class="card-stat-value">16%-20%</div></div>
                    <div class="card-stat"><div class="card-stat-label">æœ€å°æŠ•è³‡é¡</div><div class="card-stat-value">2,000 USDT</div></div>
                </div>
                <div class="card-extra">
                    <div class="card-extra-item"><div class="card-extra-label">é‹è¡Œæ™‚é–“</div><div class="card-extra-value">12å¤© 8æ™‚ 45åˆ†</div></div>
                    <div class="card-extra-item"><div class="card-extra-label">7å¤©æœ€å¤§å›æ’¤</div><div class="card-extra-value">1.85%</div></div>
                </div>
                <button class="join-btn" onclick="openDetail(this)">ç«‹å³åƒèˆ‡</button>
                <div class="limit-text">æ¯æœˆé™åƒèˆ‡1æ¬¡</div>
            </div>
            <div class="card" data-name="AIé›™å‘å¹³è¡¡ç­–ç•¥" data-min="10,000" data-max="49,999" data-rate-min="15" data-rate-max="18">
                <div class="card-title">AIé›™å‘å¹³è¡¡ç­–ç•¥</div>
                <div class="card-users">10504</div>
                <div class="card-profit-row">
                    <div class="card-profit-left">
                        <div class="card-profit-label">æ”¶ç›Šé¡ (USDT)</div>
                        <div class="card-profit-value">$8,932.55</div>
                    </div>
                    <div class="card-chart"></div>
                </div>
                <div class="card-stats">
                    <div class="card-stat"><div class="card-stat-label">æ”¶ç›Šç‡</div><div class="card-stat-value">15%-18%</div></div>
                    <div class="card-stat"><div class="card-stat-label">æœ€å°æŠ•è³‡é¡</div><div class="card-stat-value">10,000 USDT</div></div>
                </div>
                <div class="card-extra">
                    <div class="card-extra-item"><div class="card-extra-label">é‹è¡Œæ™‚é–“</div><div class="card-extra-value">3å¤© 15æ™‚ 30åˆ†</div></div>
                    <div class="card-extra-item"><div class="card-extra-label">7å¤©æœ€å¤§å›æ’¤</div><div class="card-extra-value">3.12%</div></div>
                </div>
                <button class="join-btn" onclick="openDetail(this)">ç«‹å³åƒèˆ‡</button>
                <div class="limit-text">æ¯æœˆé™åƒèˆ‡1æ¬¡</div>
            </div>
            <div class="card" data-name="AI Alphaç©©å¥ç­–ç•¥-å¤šå¹£ç¨®" data-min="50,000" data-max="99,999" data-rate-min="12" data-rate-max="16">
                <div class="card-title">AI Alphaç©©å¥ç­–ç•¥-å¤šå¹£ç¨®</div>
                <div class="card-users">3256</div>
                <div class="card-profit-row">
                    <div class="card-profit-left">
                        <div class="card-profit-label">æ”¶ç›Šé¡ (USDT)</div>
                        <div class="card-profit-value">$5,621.33</div>
                    </div>
                    <div class="card-chart"></div>
                </div>
                <div class="card-stats">
                    <div class="card-stat"><div class="card-stat-label">æ”¶ç›Šç‡</div><div class="card-stat-value">12%-16%</div></div>
                    <div class="card-stat"><div class="card-stat-label">æœ€å°æŠ•è³‡é¡</div><div class="card-stat-value">50,000 USDT</div></div>
                </div>
                <div class="card-extra">
                    <div class="card-extra-item"><div class="card-extra-label">é‹è¡Œæ™‚é–“</div><div class="card-extra-value">8å¤© 5æ™‚ 22åˆ†</div></div>
                    <div class="card-extra-item"><div class="card-extra-label">7å¤©æœ€å¤§å›æ’¤</div><div class="card-extra-value">1.56%</div></div>
                </div>
                <button class="join-btn" onclick="openDetail(this)">ç«‹å³åƒèˆ‡</button>
                <div class="limit-text">æ¯æœˆé™åƒèˆ‡1æ¬¡</div>
            </div>
        </div>
    </div>

    <!-- è¯¦æƒ…é¡µ -->
    <div id="detailPage" class="page">
        <div class="header">
            <div class="back-btn" onclick="goBack()"></div>
            <div class="header-title">AIé‡åŒ–è·Ÿå–®</div>
            <div class="placeholder"></div>
        </div>
        <div class="detail-container">
            <div class="section-label">ç”¢å“åç¨±</div>
            <div class="product-name" id="productName">AI Copy ç†±ç´æ‰£é©…å‹•ç­–ç•¥</div>
            <div class="section-label">åƒèˆ‡é‡‘é¡</div>
            <div class="input-box">
                <input type="text" id="amountInput" placeholder="æœ€å°‘èµ·æŠ•: 100">
                <span class="unit">USDT</span>
                <span class="all-btn">å…¨éƒ¨</span>
            </div>
            <div class="balance-row">å¸³æˆ¶é¤˜é¡: 0.00 USDT <span class="add-icon">âŠ•</span></div>

            <div class="chart-section">
                <div class="chart-title">æ­·å²ç›ˆåˆ©</div>
                <div class="chart-summary">
                    <div class="chart-summary-left">
                        <div class="chart-summary-label">æ”¶ç›Šç‡</div>
                        <div class="chart-summary-value green" id="detailYieldRate">1.77%</div>
                    </div>
                    <div class="chart-summary-right">
                        <div class="chart-summary-label">æ”¶ç›Šé¡ (USD)</div>
                        <div class="chart-summary-value green" id="detailProfit">$7,106.82</div>
                    </div>
                </div>
                <div class="chart-container" id="detailChart"></div>
                <div class="chart-tooltip" id="chartTooltip"></div>
            </div>

            <div class="section-label">åƒèˆ‡é‡‘é¡æ§åˆ¶</div>
            <div class="info-row"><span class="label">æœ€å°‘èµ·æŠ•</span><span class="value" id="minAmount">100 USDT</span></div>
            <div class="info-row"><span class="label">æœ€å¤§èµ·æŠ•</span><span class="value" id="maxAmount">2,000 USDT</span></div>
            <div class="info-row"><span class="label">æ”¶ç›Šå¹£ç¨®</span><span class="value">USDT</span></div>
            <div class="info-row"><span class="label">é è¨ˆæ”¶ç›Š</span><span class="value highlight">æ¯æ—¥ 0.00 USDT</span></div>
            <div class="section-label">åƒèˆ‡è¦å‰‡</div>
            <div class="rule-item"><div class="rule-dot"></div><span class="rule-label">ç”³è³¼æ™‚é–“</span><span class="rule-value">2025-12-08 10:52</span></div>
            <div class="rule-item"><div class="rule-dot"></div><span class="rule-label">è¨ˆæ¯é–‹å§‹</span><span class="rule-value">2025-12-08 23:00</span></div>
            <div class="rule-item"><div class="rule-dot"></div><span class="rule-label">é¦–ç­†æ”¶ç›Šç™¼æ”¾</span><span class="rule-value">2025-12-09 23:00</span></div>

            <div class="section-label">ç­–ç•¥å„ªå‹¢</div>
            <div class="strategy-features">
                <div class="feature-item">
                    <div class="feature-icon"><svg viewBox="0 0 24 24" fill="none" stroke="rgba(0,244,255,1)" stroke-width="2"><path d="M3 3v18h18"/><path d="M7 14l4-4 4 4 5-5"/><circle cx="20" cy="9" r="1.5" fill="rgba(0,244,255,1)"/></svg></div>
                    <div class="feature-content">
                        <div class="feature-title">é‡åŒ–ç®—æ³•é©…å‹•</div>
                        <div class="feature-desc">æ•¸å­¸æ¨¡å‹ + AIç®—æ³•ï¼Œç²¾æº–æ•æ‰å¸‚å ´æ©Ÿæœƒ</div>
                    </div>
                </div>
                <div class="feature-item">
                    <div class="feature-icon"><svg viewBox="0 0 24 24" fill="none" stroke="rgba(0,244,255,1)" stroke-width="2"><circle cx="12" cy="12" r="9"/><path d="M12 6v6l4 2"/></svg></div>
                    <div class="feature-content">
                        <div class="feature-title">æ­·å²å›æ¸¬é©—è­‰</div>
                        <div class="feature-desc">çœŸå¯¦æ­·å²æ•¸æ“šé©—è­‰ï¼Œå‹ç‡ã€æ”¶ç›Šã€å›æ’¤å…¨é€æ˜</div>
                    </div>
                </div>
                <div class="feature-item">
                    <div class="feature-icon"><svg viewBox="0 0 24 24" fill="none" stroke="rgba(0,244,255,1)" stroke-width="2"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/></svg></div>
                    <div class="feature-content">
                        <div class="feature-title">å¤šå…ƒè³‡ç”¢é…ç½®</div>
                        <div class="feature-desc">è·¨å¸‚å ´å¤šå¹£ç¨®é…ç½®ï¼Œæœ‰æ•ˆåˆ†æ•£å–®ä¸€è³‡ç”¢é¢¨éšª</div>
                    </div>
                </div>
                <div class="feature-item">
                    <div class="feature-icon"><svg viewBox="0 0 24 24" fill="none" stroke="rgba(0,244,255,1)" stroke-width="2"><path d="M12 2l9 4.5v5c0 5-3.5 9.7-9 11.5-5.5-1.8-9-6.5-9-11.5v-5L12 2z"/><path d="M9 12l2 2 4-4"/></svg></div>
                    <div class="feature-content">
                        <div class="feature-title">å‹•æ…‹é¢¨æ§ç®¡ç†</div>
                        <div class="feature-desc">24å°æ™‚æ™ºèƒ½ç›£æ§ï¼Œè‡ªå‹•èª¿å€‰èˆ‡é¢¨éšªå°æ²–</div>
                    </div>
                </div>
                <div class="feature-item">
                    <div class="feature-icon"><svg viewBox="0 0 24 24" fill="none" stroke="rgba(0,244,255,1)" stroke-width="2"><path d="M12 2v4m0 12v4M2 12h4m12 0h4"/><circle cx="12" cy="12" r="3"/><path d="M4.93 4.93l2.83 2.83m8.48 8.48l2.83 2.83M4.93 19.07l2.83-2.83m8.48-8.48l2.83-2.83"/></svg></div>
                    <div class="feature-content">
                        <div class="feature-title">è‡ªå‹•æ“ä½œ</div>
                        <div class="feature-desc">è‡ªå‹•è²·è³£è¨‚å–®ï¼Œçœæ™‚çœåŠ›</div>
                    </div>
                </div>
                <div class="feature-item">
                    <div class="feature-icon"><svg viewBox="0 0 24 24" fill="none" stroke="rgba(0,244,255,1)" stroke-width="2"><path d="M2 12c2-3 5-5 10-5s8 2 10 5c-2 3-5 5-10 5s-8-2-10-5z"/><path d="M7 17l2-5 3 3 4-6 3 4"/></svg></div>
                    <div class="feature-content">
                        <div class="feature-title">å¾æ³¢å‹•ä¸­ç²åˆ©</div>
                        <div class="feature-desc">æŠ“ä½å°å¹…æ³¢å‹•æ©Ÿæœƒç²åˆ©</div>
                    </div>
                </div>
                <div class="feature-item">
                    <div class="feature-icon"><svg viewBox="0 0 24 24" fill="none" stroke="rgba(0,244,255,1)" stroke-width="2"><circle cx="12" cy="12" r="9"/><circle cx="12" cy="12" r="5"/><circle cx="12" cy="12" r="1" fill="rgba(0,244,255,1)"/></svg></div>
                    <div class="feature-content">
                        <div class="feature-title">ç­–ç•¥ç©©å®š</div>
                        <div class="feature-desc">ä¿æŒç©©å®šçš„äº¤æ˜“æ–¹å¼</div>
                    </div>
                </div>
            </div>

            <div class="section-label">æ”¶ç›Šåˆ†æ</div>
            <div class="analysis-chart-card">
                <div class="analysis-chart-title">çµ„åˆæ”¶ç›Š vs åŸºæº–</div>
                <div class="analysis-chart-box">
                    <canvas id="returnCompareChart"></canvas>
                </div>
            </div>
            <div class="analysis-chart-card">
                <div class="analysis-chart-title">å› å­æ”¶ç›Šè²¢ç»</div>
                <div class="analysis-chart-box">
                    <canvas id="factorContribChart"></canvas>
                </div>
            </div>
        </div>
        <div class="agreement">
            <div class="checkbox" onclick="this.classList.toggle('checked')"></div>
            <div class="agreement-text">æˆ‘å·²é–±è®€ä¸¦åŒæ„ <a href="#">ã€Šè·Ÿå–®é¢¨éšªå”è­°ã€‹</a> å’Œ <a href="#">ã€Šè·Ÿå–®ç”¨æˆ¶å”è­°ã€‹</a></div>
        </div>
        <button class="confirm-btn">ç¢ºèª</button>
    </div>

    <script>
        // ç”Ÿæˆæ¨¡æ‹Ÿ7å¤©å°æ—¶æ”¶ç›Šæ•°æ®çš„å›¾è¡¨
        function generateChart(container, seed) {
            const width = 120, height = 50, points = 168; // 7å¤©æ¯å°æ—¶ä¸€ä¸ªç‚¹
            const midY = height / 2;

            // ä½¿ç”¨seedç”Ÿæˆä¼ªéšæœºæ•°
            const random = (s) => {
                const x = Math.sin(s) * 10000;
                return x - Math.floor(x);
            };

            // ç”Ÿæˆæ¨¡æ‹Ÿæ”¶ç›Šæ•°æ®ç‚¹
            let data = [];
            let value = 0;
            for (let i = 0; i < points; i++) {
                value += (random(seed + i) - 0.45) * 8; // ç•¥å¾®åå‘ç›ˆåˆ©
                data.push(value);
            }

            // å½’ä¸€åŒ–åˆ°å›¾è¡¨é«˜åº¦
            const minVal = Math.min(...data);
            const maxVal = Math.max(...data);
            const range = Math.max(Math.abs(minVal), Math.abs(maxVal)) * 2 || 1;

            const pointsArr = data.map((v, i) => {
                const x = (i / (points - 1)) * width;
                const y = midY - (v / range) * (height - 10);
                return { x, y, value: v };
            });

            // æ„å»ºSVGè·¯å¾„ - åˆ†æ®µç»˜åˆ¶ç»¿è‰²å’Œçº¢è‰²
            let greenPath = '', redPath = '';
            for (let i = 0; i < pointsArr.length - 1; i++) {
                const p1 = pointsArr[i], p2 = pointsArr[i + 1];

                if (p1.value >= 0 && p2.value >= 0) {
                    greenPath += `M${p1.x},${p1.y} L${p2.x},${p2.y} `;
                } else if (p1.value < 0 && p2.value < 0) {
                    redPath += `M${p1.x},${p1.y} L${p2.x},${p2.y} `;
                } else {
                    // è·¨è¶Šé›¶çº¿ï¼Œè®¡ç®—äº¤å‰ç‚¹
                    const ratio = Math.abs(p1.value) / (Math.abs(p1.value) + Math.abs(p2.value));
                    const crossX = p1.x + (p2.x - p1.x) * ratio;
                    const crossY = midY;
                    if (p1.value >= 0) {
                        greenPath += `M${p1.x},${p1.y} L${crossX},${crossY} `;
                        redPath += `M${crossX},${crossY} L${p2.x},${p2.y} `;
                    } else {
                        redPath += `M${p1.x},${p1.y} L${crossX},${crossY} `;
                        greenPath += `M${crossX},${crossY} L${p2.x},${p2.y} `;
                    }
                }
            }

            const svg = `<svg viewBox="0 0 ${width} ${height}">
                <line x1="0" y1="${midY}" x2="${width}" y2="${midY}" stroke="#555" stroke-width="1" stroke-dasharray="3,2"/>
                <path d="${greenPath}" fill="none" stroke="#0d956f" stroke-width="1.5" stroke-linecap="round"/>
                <path d="${redPath}" fill="none" stroke="#e74c3c" stroke-width="1.5" stroke-linecap="round"/>
            </svg>`;

            container.innerHTML = svg;
        }

        // åˆå§‹åŒ–æ‰€æœ‰å›¾è¡¨ï¼Œå¹¶ç»™å¡ç‰‡å­˜å‚¨seed
        document.querySelectorAll('.card').forEach((card, index) => {
            const seed = (index + 1) * 123.456;
            card.dataset.chartSeed = seed;
            const chart = card.querySelector('.card-chart');
            if (chart) generateChart(chart, seed);
        });

        // è¯¦æƒ…é¡µäº¤äº’å¼å›¾è¡¨
        let detailChartData = [];
        function generateDetailChart(container, seed = 12345) {
            const width = container.clientWidth || 340;
            const height = 160;
            const padding = { left: 50, right: 16, top: 10, bottom: 30 };
            const chartW = width - padding.left - padding.right;
            const chartH = height - padding.top - padding.bottom;

            // ä½¿ç”¨ä¸åˆ—è¡¨é¡µç›¸åŒçš„ä¼ªéšæœºç®—æ³•
            const random = (s) => {
                const x = Math.sin(s) * 10000;
                return x - Math.floor(x);
            };

            // ç”Ÿæˆ168å°æ—¶æ•°æ®ï¼ˆ7å¤©ï¼Œä¸åˆ—è¡¨é¡µä¸€è‡´ï¼‰
            const points = [];
            let value = 0;
            const startDate = new Date('2024-12-01T00:00:00');
            for (let i = 0; i < 168; i++) {
                const date = new Date(startDate.getTime() + i * 3600000);
                value += (random(seed + i) - 0.45) * 800; // ä¸åˆ—è¡¨é¡µç›¸åŒçš„ç®—æ³•
                points.push({ hour: i, value: value, date: date });
            }
            detailChartData = points;

            const values = points.map(p => p.value);
            const minVal = Math.min(...values);
            const maxVal = Math.max(...values);
            const range = Math.max(Math.abs(maxVal), Math.abs(minVal)) * 1.2;

            // Yè½´åˆ»åº¦
            const yTicks = [-range, -range/2, 0, range/2, range].map(v => Math.round(v / 1000) * 1000);
            const yLabels = yTicks.map(v => {
                const y = padding.top + chartH / 2 - (v / range) * (chartH / 2);
                return `<text x="${padding.left - 8}" y="${y + 4}" fill="#666" font-size="11" text-anchor="end">${(v/1000).toFixed(0)}${v !== 0 ? ',000' : ''}</text>`;
            }).join('');

            // Xè½´åˆ»åº¦ï¼ˆæ¯å¤©ä¸€ä¸ªï¼Œå…±7å¤©ï¼‰
            const xLabels = [0, 24, 48, 72, 96, 120, 144, 168].map(h => {
                const x = padding.left + (h / 168) * chartW;
                const d = new Date(startDate.getTime() + h * 3600000);
                const label = `${(d.getMonth()+1).toString().padStart(2,'0')}-${d.getDate().toString().padStart(2,'0')}`;
                return `<text x="${x}" y="${height - 6}" fill="#666" font-size="10" text-anchor="middle">${label}</text>`;
            }).join('');

            // è®¡ç®—åæ ‡
            const coords = points.map((p, i) => ({
                x: padding.left + (i / (points.length - 1)) * chartW,
                y: padding.top + chartH / 2 - (p.value / range) * (chartH / 2)
            }));

            // ç»˜åˆ¶è·¯å¾„ï¼ˆçº¢ç»¿åˆ†ç¦»ï¼‰
            const zeroY = padding.top + chartH / 2;
            let greenPath = '', redPath = '';
            for (let i = 0; i < coords.length - 1; i++) {
                const p1 = coords[i], p2 = coords[i + 1];
                const v1 = points[i].value, v2 = points[i + 1].value;
                if (v1 >= 0 && v2 >= 0) {
                    greenPath += (greenPath.includes(`L${p1.x}`) ? '' : `M${p1.x},${p1.y} `) + `L${p2.x},${p2.y} `;
                } else if (v1 < 0 && v2 < 0) {
                    redPath += (redPath.includes(`L${p1.x}`) ? '' : `M${p1.x},${p1.y} `) + `L${p2.x},${p2.y} `;
                } else {
                    const ratio = Math.abs(v1) / (Math.abs(v1) + Math.abs(v2));
                    const crossX = p1.x + ratio * (p2.x - p1.x);
                    if (v1 >= 0) {
                        greenPath += `M${p1.x},${p1.y} L${crossX},${zeroY} `;
                        redPath += `M${crossX},${zeroY} L${p2.x},${p2.y} `;
                    } else {
                        redPath += `M${p1.x},${p1.y} L${crossX},${zeroY} `;
                        greenPath += `M${crossX},${zeroY} L${p2.x},${p2.y} `;
                    }
                }
            }

            const svg = `<svg viewBox="0 0 ${width} ${height}" style="width:100%;height:${height}px;" id="detailChartSvg">
                <line x1="${padding.left}" y1="${zeroY}" x2="${width - padding.right}" y2="${zeroY}" stroke="#444" stroke-width="1" stroke-dasharray="3,2"/>
                ${yLabels}
                ${xLabels}
                <path d="${greenPath}" fill="none" stroke="#0d956f" stroke-width="2" stroke-linecap="round"/>
                <path d="${redPath}" fill="none" stroke="#e74c3c" stroke-width="2" stroke-linecap="round"/>
                <rect x="${padding.left}" y="${padding.top}" width="${chartW}" height="${chartH}" fill="transparent" id="chartHitArea"/>
            </svg>`;
            container.innerHTML = svg;
            container.dataset.paddingLeft = padding.left;
            container.dataset.chartW = chartW;
        }

        function setupChartInteraction() {
            const container = document.getElementById('detailChart');
            const tooltip = document.getElementById('chartTooltip');

            container.addEventListener('click', function(e) {
                const rect = container.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const paddingLeft = parseFloat(container.dataset.paddingLeft);
                const chartW = parseFloat(container.dataset.chartW);

                if (x < paddingLeft || x > paddingLeft + chartW) return;

                const ratio = (x - paddingLeft) / chartW;
                const idx = Math.round(ratio * (detailChartData.length - 1));
                const point = detailChartData[idx];
                if (!point) return;

                const d = point.date;
                const timeStr = `${(d.getMonth()+1).toString().padStart(2,'0')}-${d.getDate().toString().padStart(2,'0')} ${d.getHours().toString().padStart(2,'0')}:00`;
                const valueStr = (point.value >= 0 ? '+' : '') + point.value.toFixed(2);
                const colorClass = point.value >= 0 ? 'green' : 'red';

                tooltip.innerHTML = `<div class="tooltip-time">${timeStr}</div><div class="tooltip-value ${colorClass}">æ”¶ç›Šé¡: ${valueStr}</div>`;
                tooltip.style.left = (x - 50) + 'px';
                tooltip.style.top = '40px';
                tooltip.classList.add('show');

                setTimeout(() => tooltip.classList.remove('show'), 2500);
            });
        }

        // Chart.js å›¾è¡¨å®ä¾‹
        let returnCompareChart, factorContribChart;
        let chartTime = 0;
        let chartUpdateInterval = null;
        let currentRateMin = 18, currentRateMax = 20;

        // åŸºå‡†å·®å€¼ï¼ˆç»„åˆæ¯”åŸºå‡†é«˜5%-8%ï¼‰
        const benchmarkGap = 5 + Math.random() * 3;

        function generateReturnData() {
            const labels = [];
            const portfolioData = [];
            const benchmarkData = [];
            const alphaData = [];

            const rateCenter = (currentRateMin + currentRateMax) / 2;
            const rateRange = (currentRateMax - currentRateMin) / 2;

            for (let i = 0; i <= 30; i++) {
                labels.push(`D${i}`);
                // ç»„åˆæ”¶ç›Šåœ¨æ‰¿è¯ºèŒƒå›´å†…æ³¢åŠ¨
                const progress = i / 30;
                const wave = Math.sin(i * 0.25 + chartTime * 0.05) * rateRange * 0.8;
                const portfolio = currentRateMin + (rateCenter - currentRateMin) * progress + wave + Math.sin(chartTime * 0.03) * 0.5;
                const portfolioFinal = Math.max(currentRateMin * 0.9, portfolio);
                // åŸºå‡†æ”¶ç›Š = ç»„åˆæ”¶ç›Š - 5%~8%
                const benchmark = portfolioFinal - benchmarkGap + Math.sin(i * 0.15) * 0.5;
                const alpha = portfolioFinal - benchmark;

                portfolioData.push(portfolioFinal.toFixed(2));
                benchmarkData.push(benchmark.toFixed(2));
                alphaData.push(alpha.toFixed(2));
            }
            return { labels, portfolioData, benchmarkData, alphaData };
        }

        function generateFactorData() {
            return [
                { name: 'å‹•é‡', value: 2.5 + Math.sin(chartTime * 0.08) * 1.2 },
                { name: 'åƒ¹å€¼', value: 1.8 + Math.cos(chartTime * 0.06) * 0.8 },
                { name: 'è³ªé‡', value: 1.5 + Math.sin(chartTime * 0.09 + 1) * 0.6 },
                { name: 'æ³¢å‹•ç‡', value: -0.8 + Math.sin(chartTime * 0.07) * 0.5 },
                { name: 'è¦æ¨¡', value: 0.6 + Math.cos(chartTime * 0.1) * 0.4 },
                { name: 'æµå‹•æ€§', value: 1.2 + Math.sin(chartTime * 0.05 + 2) * 0.7 }
            ];
        }

        function initAnalysisCharts() {
            const returnData = generateReturnData();

            // ç»„åˆæ”¶ç›Š vs åŸºå‡† æŠ˜çº¿å›¾
            const returnCtx = document.getElementById('returnCompareChart').getContext('2d');
            if (returnCompareChart) returnCompareChart.destroy();
            returnCompareChart = new Chart(returnCtx, {
                type: 'line',
                data: {
                    labels: returnData.labels,
                    datasets: [
                        {
                            label: 'çµ„åˆæ”¶ç›Š',
                            data: returnData.portfolioData,
                            borderColor: 'rgba(0, 244, 255, 1)',
                            backgroundColor: 'rgba(0, 244, 255, 0.1)',
                            fill: true,
                            tension: 0.4,
                            pointRadius: 0,
                            borderWidth: 2
                        },
                        {
                            label: 'åŸºæº–æ”¶ç›Š',
                            data: returnData.benchmarkData,
                            borderColor: '#666',
                            backgroundColor: 'transparent',
                            tension: 0.4,
                            pointRadius: 0,
                            borderWidth: 2
                        },
                        {
                            label: 'Alpha',
                            data: returnData.alphaData,
                            borderColor: '#0d956f',
                            backgroundColor: 'transparent',
                            tension: 0.4,
                            pointRadius: 0,
                            borderWidth: 2
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: { color: '#888', boxWidth: 12, padding: 15 }
                        }
                    },
                    scales: {
                        x: {
                            grid: { color: '#333' },
                            ticks: { color: '#666', maxTicksLimit: 6 }
                        },
                        y: {
                            grid: { color: '#333' },
                            ticks: {
                                color: '#666',
                                callback: function(value) { return value + '%'; }
                            }
                        }
                    }
                }
            });

            // å› å­æ”¶ç›Šè´¡çŒ® æŸ±çŠ¶å›¾
            const factors = generateFactorData();

            const contribCtx = document.getElementById('factorContribChart').getContext('2d');
            if (factorContribChart) factorContribChart.destroy();
            factorContribChart = new Chart(contribCtx, {
                type: 'bar',
                data: {
                    labels: factors.map(f => f.name),
                    datasets: [{
                        label: 'è²¢ç»ç‡ %',
                        data: factors.map(f => f.value.toFixed(2)),
                        backgroundColor: factors.map(f => f.value >= 0 ? 'rgba(0, 244, 255, 0.7)' : 'rgba(239, 68, 68, 0.7)'),
                        borderColor: factors.map(f => f.value >= 0 ? 'rgba(0, 244, 255, 1)' : '#ef4444'),
                        borderWidth: 1,
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        x: {
                            grid: { display: false },
                            ticks: { color: '#888' }
                        },
                        y: {
                            grid: { color: '#333' },
                            ticks: { color: '#666' }
                        }
                    }
                }
            });

            // å¯åŠ¨åŠ¨æ€æ›´æ–°
            if (chartUpdateInterval) clearInterval(chartUpdateInterval);
            chartUpdateInterval = setInterval(updateAnalysisCharts, 800);
        }

        function updateAnalysisCharts() {
            chartTime++;

            if (returnCompareChart) {
                const newData = generateReturnData();
                returnCompareChart.data.datasets[0].data = newData.portfolioData;
                returnCompareChart.data.datasets[1].data = newData.benchmarkData;
                returnCompareChart.data.datasets[2].data = newData.alphaData;
                returnCompareChart.update('none');
            }

            if (factorContribChart) {
                const factors = generateFactorData();
                factorContribChart.data.datasets[0].data = factors.map(f => f.value.toFixed(2));
                factorContribChart.data.datasets[0].backgroundColor = factors.map(f => f.value >= 0 ? 'rgba(0, 244, 255, 0.7)' : 'rgba(239, 68, 68, 0.7)');
                factorContribChart.data.datasets[0].borderColor = factors.map(f => f.value >= 0 ? 'rgba(0, 244, 255, 1)' : '#ef4444');
                factorContribChart.update('none');
            }
        }

        function openDetail(btn) {
            const card = btn.closest('.card');
            document.getElementById('productName').textContent = card.dataset.name;
            document.getElementById('minAmount').textContent = card.dataset.min + ' USDT';
            document.getElementById('maxAmount').textContent = card.dataset.max + ' USDT';
            document.getElementById('amountInput').placeholder = 'æœ€å°‘èµ·æŠ•: ' + card.dataset.min.replace(',', '');

            // è·å–è¯¥äº§å“çš„æ”¶ç›Šç‡èŒƒå›´
            currentRateMin = parseFloat(card.dataset.rateMin) || 18;
            currentRateMax = parseFloat(card.dataset.rateMax) || 20;
            chartTime = 0; // é‡ç½®å›¾è¡¨æ—¶é—´

            // æ›´æ–°å†å²ç›ˆåˆ©çš„æ”¶ç›Šç‡åŒºé—´
            document.getElementById('detailYieldRate').textContent = currentRateMin + '%-' + currentRateMax + '%';

            document.getElementById('listPage').classList.remove('active');
            document.getElementById('detailPage').classList.add('active');

            // è·å–å¡ç‰‡çš„å›¾è¡¨seed
            const chartSeed = parseFloat(card.dataset.chartSeed) || 123.456;

            // å»¶è¿Ÿç»˜åˆ¶å›¾è¡¨ç¡®ä¿å®¹å™¨å¯è§
            setTimeout(() => {
                generateDetailChart(document.getElementById('detailChart'), chartSeed);
                setupChartInteraction();
                initAnalysisCharts();
            }, 100);
        }
        function goBack() {
            document.getElementById('detailPage').classList.remove('active');
            document.getElementById('listPage').classList.add('active');
            // åœæ­¢å›¾è¡¨æ›´æ–°
            if (chartUpdateInterval) {
                clearInterval(chartUpdateInterval);
                chartUpdateInterval = null;
            }
        }
    </script>
</body>
</html>

